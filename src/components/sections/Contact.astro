---
import { parseText } from '@/utils/textParser';
import { Icon } from 'astro-icon/components';

const pt = (text: string) => parseText(text);

// FAQ Data Structure - Dynamic content management
interface FAQItem {
  id: string;
  question: string;
  answer: string;
  category?: 'general' | 'pricing' | 'technical' | 'process';
}

const faqData: FAQItem[] = [
  {
    id: 'startups',
    question: '¿Trabajás con startups?',
    answer:
      'Sí, me especializo en startups early-stage que necesitan producto y diseño de calidad desde el día uno.',
    category: 'general',
  },
  {
    id: 'pricing',
    question: '¿Cuál es tu rango de precios?',
    answer:
      'Depende del alcance. Desde $1K USD para sitios web hasta $8K+ para aplicaciones complejas. Todo depende del alcance y del proyecto.',
    category: 'pricing',
  },
  {
    id: 'consulting',
    question: '¿Brindás asesorías para productos existentes?',
    answer:
      'Sí, ofrezco auditorías UX/UI y consultoría estratégica para mejorar productos digitales existentes. Desde optimización de conversión hasta refactoring de arquitectura.',
    category: 'process',
  },
  {
    id: 'education',
    question: '¿Das clases o cursos?',
    answer:
      'Ocasionalmente doy workshops sobre design systems y desarrollo frontend. También mentoría one-on-one para designers que quieren aprender código.',
    category: 'general',
  },
  {
    id: 'remote',
    question: '¿Trabajás de forma remota?',
    answer:
      '100% remoto desde Argentina. Tengo experiencia coordinando con equipos en USA, Europa y LATAM. Adaptable a diferentes husos horarios.',
    category: 'process',
  },
  {
    id: 'technologies',
    question: '¿Qué tecnologías manejás?',
    answer:
      'Frontend: React, Vue, Astro, TypeScript. Design: Figma, Adobe Suite. Backend: Node.js, Python. Siempre adaptándome a las necesidades del proyecto.',
    category: 'technical',
  },
  {
    id: 'maintenance',
    question: '¿Incluís mantenimiento post-lanzamiento?',
    answer:
      'Ofrezco paquetes de mantenimiento mensual y soporte técnico. También documentación completa para que tu equipo pueda gestionar updates básicos.',
    category: 'process',
  },
];

// Availability status data
interface AvailabilityInfo {
  status: 'available' | 'busy' | 'limited';
  statusText: string;
  responseTime: string;
  meetingAvailable: boolean;
  timezone: string;
  description: string;
}

const availabilityInfo: AvailabilityInfo = {
  status: 'available',
  statusText: 'Disponible para nuevos proyectos',
  responseTime: 'Respuesta en menos de 24hs',
  meetingAvailable: true,
  timezone: 'UTC-3 (Argentina)',
  description:
    'Prefiero proyectos de mediano/largo plazo donde pueda aplicar un enfoque estratégico y crear soluciones excepcionales.',
};

// Contact methods data
interface ContactMethod {
  id: string;
  name: string;
  icon: string;
  url: string;
  username: string;
  ariaLabel: string;
}

const contactMethods: ContactMethod[] = [
  {
    id: 'email',
    name: 'Email',
    icon: 'heroicons:envelope',
    url: 'mailto:agus@moura.ar',
    username: 'agus@moura.ar',
    ariaLabel: 'Enviar email a agus@moura.ar',
  },
  {
    id: 'linkedin',
    name: 'LinkedIn',
    icon: 'simple-icons:linkedin',
    url: 'https://linkedin.com/in/agustin-mourino',
    username: '/in/agustin-mourino',
    ariaLabel: 'Visitar perfil de LinkedIn de Agustín Mouriño',
  },
  {
    id: 'github',
    name: 'GitHub',
    icon: 'simple-icons:github',
    url: 'https://github.com/agusmoura',
    username: '@agusmoura',
    ariaLabel: 'Visitar perfil de GitHub de Agustín Mouriño',
  },
  {
    id: 'twitter',
    name: 'Twitter / X',
    icon: 'simple-icons:x',
    url: 'https://x.com/agus_moura',
    username: '@agus_moura',
    ariaLabel: 'Visitar perfil de Twitter de Agustín Mouriño',
  },
];

// Project types data structure
interface ProjectType {
  id: string;
  value: string;
  name: string;
  icon: string;
  description?: string;
  category?: 'frontend' | 'backend' | 'design' | 'consulting' | 'mobile' | 'ai';
}

const projectTypes: ProjectType[] = [
  {
    id: 'website',
    value: 'website',
    name: 'Sitio Web',
    icon: 'heroicons:globe-alt',
    description: 'Landing pages, sitios corporativos, portfolios',
    category: 'frontend',
  },
  {
    id: 'web-app',
    value: 'web-app',
    name: 'Web App',
    icon: 'heroicons:computer-desktop',
    description: 'Aplicaciones web complejas, dashboards, SaaS',
    category: 'frontend',
  },
  {
    id: 'ui-ux',
    value: 'ui-ux',
    name: 'UX/UI',
    icon: 'heroicons:paint-brush',
    description: 'Diseño de interfaces, research, wireframing',
    category: 'design',
  },
  {
    id: 'backend',
    value: 'backend',
    name: 'Backend',
    icon: 'heroicons:server',
    description: 'APIs, bases de datos, arquitectura de sistemas',
    category: 'backend',
  },
  {
    id: 'ai',
    value: 'ai',
    name: 'IA/LLM',
    icon: 'heroicons:cpu-chip',
    description: 'Integración de IA, chatbots, automatización',
    category: 'ai',
  },
  {
    id: 'mobile',
    value: 'mobile',
    name: 'App Móvil',
    icon: 'heroicons:device-phone-mobile',
    description: 'Aplicaciones nativas y PWA',
    category: 'mobile',
  },
  {
    id: 'ecommerce',
    value: 'ecommerce',
    name: 'E-commerce',
    icon: 'heroicons:shopping-cart',
    description: 'Tiendas online, pasarelas de pago, inventario',
    category: 'frontend',
  },
  {
    id: 'consulting',
    value: 'consulting',
    name: 'Consultoría',
    icon: 'heroicons:light-bulb',
    description: 'Auditorías, estrategia digital, optimización',
    category: 'consulting',
  },
];
---

<section id="contact" class="relative pt-20 md:pt-32 overflow-hidden">
  <div class="container relative mx-auto px-4 lg:px-8 xl:max-w-6xl w-full max-w-full">
    <!-- Enhanced Hero Section with stronger value proposition -->
    <header class="mb-16 space-y-8 text-center md:mb-20 max-w-full">
      <!-- Status Badge -->
      <div class="mb-6 inline-block w-full max-w-full" data-aos="fade-up" data-aos-duration="600">
        <div
          class="inline-flex items-center gap-3 px-4 py-2 rounded-full bg-accent/10 border border-accent/20 backdrop-blur-sm"
        >
          <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse" aria-hidden="true"></div>
          <span class="text-sm font-medium text-accent-light uppercase tracking-wide"
            >Disponible para nuevos proyectos</span
          >
          <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse" aria-hidden="true"></div>
        </div>
      </div>

      <!-- Main Heading with improved hierarchy -->
      <div class="space-y-6 max-w-full">
        <h2
          class="font-serif text-3xl sm:text-4xl md:text-5xl lg:text-6xl xl:text-7xl font-bold tracking-tight leading-tight text-balance max-w-full px-2 sm:px-0"
          set:html={pt('Transformemos tu [[**visión**]] en [[**realidad digital**]]')}
          data-aos="fade-up"
          data-aos-duration="800"
          data-aos-delay="200"
        />

        <p
          class="text-foreground mx-auto max-w-full sm:max-w-lg md:max-w-3xl text-base sm:text-lg md:text-xl leading-relaxed px-2 sm:px-0 opacity-90"
          set:html={pt(
            'Cada proyecto excepcional comienza con una conversación. Te acompaño desde la [[**idea inicial**]] hasta el [[**lanzamiento**]], creando soluciones que realmente [[**funcionan**]].'
          )}
          data-aos="fade-up"
          data-aos-duration="800"
          data-aos-delay="400"
        />
      </div>
    </header>

    <!-- Enhanced Layout Structure with improved hierarchy -->
    <div class="relative mb-16 md:mb-24 max-w-full">
      <!-- Decorative number - optimized positioning and hidden on mobile -->
      <span
        class="absolute -left-2 -top-2 text-4xl font-bold text-white/5 hidden lg:block xl:-left-6 xl:-top-6 xl:text-6xl select-none pointer-events-none"
        aria-hidden="true">03</span
      >

      <div class="grid grid-cols-1 gap-8 lg:grid-cols-2 lg:gap-8 max-w-full">
        <!-- Primary Column: Contact Form (spans 2 columns on large screens) -->
        <div class="order-1 w-full max-w-full">
          <!-- Contact Form Component -->
          <div
            class="relative w-full max-w-full space-y-6 rounded-2xl border border-white/5 bg-background/10 p-4 sm:p-6 md:p-8 backdrop-blur-xs overflow-hidden"
            data-aos="fade-in"
            data-aos-duration="800"
            data-aos-delay="400"
          >
            <div>
              <h3 class="mb-4 text-2xl font-bold md:mb-6 md:text-3xl">
                <span
                  class="bg-gradient-to-r from-accent-light to-accent bg-clip-text text-transparent font-serif font-bold"
                >
                  Enviar mensaje
                </span>
              </h3>

              <p class="text-light-2 text-sm mb-6 md:text-base">
                Todos los campos son obligatorios. Respondo personalmente en menos de 24 horas.
              </p>

              <!-- Enhanced Form with better accessibility -->
              <form
                class="space-y-6"
                action="/api/contact"
                method="POST"
                novalidate
                id="contact-form"
                role="form"
                aria-label="Formulario de contacto"
              >
                <!-- Name Field - enhanced accessibility -->
                <div class="form-field group">
                  <label for="name" class="form-label">
                    <span class="label-text">Nombre completo</span>
                    <span class="label-required" aria-label="campo obligatorio">*</span>
                  </label>
                  <div class="input-wrapper">
                    <input
                      type="text"
                      id="name"
                      name="name"
                      required
                      autocomplete="name"
                      inputmode="text"
                      placeholder="Ej: Juan Pérez"
                      class="form-input"
                      data-validate="name"
                      aria-describedby="name-error"
                      maxlength="50"
                      minlength="2"
                    />
                    <div class="input-icon" aria-hidden="true">
                      <Icon name="heroicons:user" class="w-5 h-5" />
                    </div>
                    <div class="validation-icon hidden" aria-hidden="true">
                      <Icon name="heroicons:check-circle" class="w-5 h-5 text-green-500" />
                    </div>
                  </div>
                  <div class="form-error hidden" id="name-error" role="alert" aria-live="polite">
                    <Icon name="heroicons:exclamation-circle" class="w-4 h-4" aria-hidden="true" />
                    <span>Por favor, ingresá tu nombre completo (2-50 caracteres)</span>
                  </div>
                </div>

                <!-- Email Field - enhanced validation -->
                <div class="form-field group">
                  <label for="email" class="form-label">
                    <span class="label-text">Email</span>
                    <span class="label-required" aria-label="campo obligatorio">*</span>
                  </label>
                  <div class="input-wrapper">
                    <input
                      type="email"
                      id="email"
                      name="email"
                      required
                      autocomplete="email"
                      inputmode="email"
                      placeholder="tu@email.com"
                      class="form-input"
                      data-validate="email"
                      aria-describedby="email-error email-help"
                    />
                    <div class="input-icon" aria-hidden="true">
                      <Icon name="heroicons:envelope" class="w-5 h-5" />
                    </div>
                    <div class="validation-icon hidden" aria-hidden="true">
                      <Icon name="heroicons:check-circle" class="w-5 h-5 text-green-500" />
                    </div>
                  </div>
                  <div class="form-help text-xs text-light-2 mt-1" id="email-help">
                    Usaremos este email para responderte
                  </div>
                  <div class="form-error hidden" id="email-error" role="alert" aria-live="polite">
                    <Icon name="heroicons:exclamation-circle" class="w-4 h-4" aria-hidden="true" />
                    <span>Ingresá una dirección de email válida</span>
                  </div>
                </div>

                <!-- Project Type Pills - improved keyboard navigation -->
                <fieldset class="form-field group">
                  <legend class="form-label">
                    <span class="label-text">Tipo de proyecto</span>
                    <span class="label-required" aria-label="campo obligatorio">*</span>
                  </legend>
                  <div
                    class="project-pills"
                    role="group"
                    aria-describedby="project-type-help project-type-error"
                  >
                    {
                      projectTypes.map((projectType) => (
                        <label
                          class="project-pill"
                          id={`project-${projectType.id}`}
                          title={projectType.description}
                        >
                          <input
                            type="checkbox"
                            name="project-type"
                            value={projectType.value}
                            class="pill-input sr-only"
                          />
                          <div class="pill-content">
                            <Icon
                              name={projectType.icon}
                              class="w-4 h-4 md:w-5 md:h-5 flex-shrink-0"
                              aria-hidden="true"
                            />
                            <span class="text-xs md:text-sm truncate">{projectType.name}</span>
                            <div class="pill-check" aria-hidden="true">
                              <Icon name="heroicons:check" class="w-2 h-2" />
                            </div>
                          </div>
                        </label>
                      ))
                    }
                  </div>
                  <p class="project-pills-help text-xs text-light-2 mt-2" id="project-type-help">
                    Seleccioná uno o más tipos que se ajusten a tu proyecto
                  </p>
                  <div
                    class="form-error hidden"
                    id="project-type-error"
                    role="alert"
                    aria-live="polite"
                  >
                    <Icon name="heroicons:exclamation-circle" class="w-4 h-4" aria-hidden="true" />
                    <span>Seleccioná al menos un tipo de proyecto</span>
                  </div>
                </fieldset>

                <!-- Message Field - enhanced with character counter -->
                <div class="form-field group">
                  <label for="message" class="form-label">
                    <span class="label-text">Contame sobre tu proyecto</span>
                    <span class="label-required" aria-label="campo obligatorio">*</span>
                  </label>
                  <div class="textarea-wrapper">
                    <textarea
                      id="message"
                      name="message"
                      inputmode="text"
                      required
                      rows="5"
                      placeholder="Describí tu proyecto, objetivos, timeline y cualquier detalle que consideres importante..."
                      class="form-textarea"
                      data-validate="message"
                      minlength="20"
                      maxlength="500"
                      aria-describedby="message-counter message-error message-help"></textarea>
                    <div class="textarea-counter" id="message-counter" aria-live="polite">
                      <span class="counter-text">0 / 500</span>
                    </div>
                  </div>
                  <div class="form-help text-xs text-light-2 mt-1" id="message-help">
                    Incluí detalles sobre alcance, timeline y presupuesto aproximado
                  </div>
                  <div class="form-error hidden" id="message-error" role="alert" aria-live="polite">
                    <Icon name="heroicons:exclamation-circle" class="w-4 h-4" aria-hidden="true" />
                    <span>El mensaje debe tener entre 20 y 500 caracteres</span>
                  </div>
                </div>

                <!-- UTM Parameters Hidden Fields -->
                <div aria-hidden="true" style="display: none;">
                  <input type="hidden" name="utm_source" id="utm_source" value="" />
                  <input type="hidden" name="utm_medium" id="utm_medium" value="" />
                  <input type="hidden" name="utm_campaign" id="utm_campaign" value="" />
                  <input type="hidden" name="utm_term" id="utm_term" value="" />
                  <input type="hidden" name="utm_content" id="utm_content" value="" />
                  <input type="hidden" name="utm_id" id="utm_id" value="" />
                </div>

                <!-- Enhanced Honeypot field (multiple techniques) -->
                <div
                  aria-hidden="true"
                  style="position: absolute; left: -5000px; width: 1px; height: 1px; opacity: 0; pointer-events: none;"
                >
                  <label for="website">No completar este campo</label>
                  <input
                    type="text"
                    id="website"
                    name="website"
                    tabindex="-1"
                    autocomplete="off"
                    value=""
                  />
                  <input
                    type="email"
                    name="email_confirm"
                    tabindex="-1"
                    autocomplete="off"
                    value=""
                  />
                  <input type="text" name="phone" tabindex="-1" autocomplete="off" value="" />
                  <input type="url" name="url" tabindex="-1" autocomplete="off" value="" />
                  <input type="text" name="company" tabindex="-1" autocomplete="off" value="" />
                </div>

                <!-- Enhanced Submit Button with loading states -->
                <div class="form-submit">
                  <button
                    type="submit"
                    class="submit-button group"
                    disabled
                    id="submit-btn"
                    aria-describedby="submit-help"
                  >
                    <span class="button-content flex items-center justify-center gap-2">
                      <Icon
                        name="heroicons:paper-airplane"
                        class="w-5 h-5 transition-transform group-hover:translate-x-1"
                        aria-hidden="true"
                      />
                      <span class="button-text">Enviar mensaje</span>
                    </span>
                    <div class="button-loader hidden flex items-center justify-center gap-2">
                      <div class="loader-spinner" aria-hidden="true"></div>
                      <span>Enviando...</span>
                    </div>
                  </button>

                  <div
                    class="submit-help flex items-center justify-center gap-2 mt-3"
                    id="submit-help"
                  >
                    <Icon
                      name="heroicons:shield-check"
                      class="w-4 h-4 text-accent"
                      aria-hidden="true"
                    />
                    <span class="text-xs text-light-2">Respuesta garantizada en menos de 24hs</span>
                  </div>
                </div>
              </form>

              {/* Decorative elements */}
              <div
                class="mt-6 mb-4 h-px w-full bg-gradient-to-r from-transparent via-accent to-transparent md:mt-8 md:mb-6"
              >
              </div>

              <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
                <div class="flex space-x-2">
                  {
                    [1, 2, 3].map((i) => (
                      <div
                        class="w-2 h-2 bg-accent rounded-full animate-pulse"
                        style={{ animationDelay: `${i * 0.5}s` }}
                      />
                    ))
                  }
                </div>
                <p class="text-xs text-foreground/70 uppercase tracking-wider font-mono">
                  También podés contactarme directamente →
                </p>
              </div>
            </div>
          </div>
        </div>

        <!-- Secondary Column: Support Information -->
        <div
          class="order-2 lg:order-2 lg:col-span-1 space-y-4 md:space-y-6 w-full max-w-full"
          data-aos="fade-in"
          data-aos-duration="1000"
          data-aos-delay="600"
        >
          <!-- Enhanced Quick Contact -->
          <div
            class="rounded-2xl border border-white/5 bg-background/10 p-4 sm:p-6 backdrop-blur-xs overflow-hidden"
          >
            <h4
              class="font-mono text-sm md:text-lg text-accent mb-4 md:mb-6 flex items-center gap-2"
            >
              <Icon
                name="heroicons:bolt"
                class="h-4 w-4 md:h-5 md:w-5 flex-shrink-0"
                aria-hidden="true"
              />
              <span class="truncate">Contacto directo</span>
            </h4>

            <div class="space-y-3">
              {
                contactMethods.map((contact) => (
                  <a
                    href={contact.url}
                    target={contact.id === 'email' ? undefined : '_blank'}
                    rel={contact.id === 'email' ? undefined : 'noopener noreferrer'}
                    class="flex items-start gap-3 md:gap-4 p-3 rounded-lg border border-white/5 bg-background/5 hover:bg-accent/5 hover:border-accent/20 transition-all duration-200 group cursor-pointer focus:outline-none focus:ring-2 focus:ring-accent focus:ring-offset-2 focus:ring-offset-background max-w-full overflow-hidden"
                    aria-label={contact.ariaLabel}
                    data-umami-event="contact_method_click"
                    data-umami-event-platform={contact.id}
                    data-umami-event-url={contact.url}
                  >
                    <div class="flex-shrink-0 w-8 h-8 md:w-10 md:h-10 bg-accent/10 group-hover:bg-accent/20 rounded-lg flex items-center justify-center transition-colors duration-200">
                      <Icon
                        name={contact.icon}
                        class="w-4 h-4 md:w-5 md:h-5 text-accent"
                        aria-hidden="true"
                      />
                    </div>
                    <div class="flex-1 min-w-0 overflow-hidden">
                      <h5 class="font-mono text-foreground font-medium mb-1 group-hover:text-accent transition-colors duration-200 text-sm md:text-base truncate">
                        {contact.name}
                      </h5>
                      <span class="text-light-2 group-hover:text-accent transition-colors duration-200 text-xs md:text-sm font-mono truncate block">
                        {contact.username}
                      </span>
                    </div>
                    <Icon
                      name="heroicons:arrow-top-right-on-square"
                      class="w-3 h-3 md:w-4 md:h-4 text-light-2 group-hover:text-accent transition-colors duration-200 mt-1 flex-shrink-0"
                      aria-hidden="true"
                    />
                  </a>
                ))
              }
            </div>
          </div>

          <!-- Enhanced Availability & Response Time -->
          <div class="rounded-2xl border border-white/5 bg-background/10 p-6 backdrop-blur-xs">
            <h4 class="font-mono text-lg text-accent mb-6 flex items-center gap-2">
              <Icon name="heroicons:clock" class="h-5 w-5" aria-hidden="true" />
              Disponibilidad
            </h4>

            <div class="space-y-4">
              <div class="flex items-center gap-3">
                <div
                  class={`w-3 h-3 rounded-full animate-pulse ${
                    availabilityInfo.status === 'available'
                      ? 'bg-green-400'
                      : availabilityInfo.status === 'limited'
                        ? 'bg-yellow-400'
                        : 'bg-red-400'
                  }`}
                  aria-hidden="true"
                >
                </div>
                <span class="text-foreground font-mono text-sm">
                  {availabilityInfo.statusText}
                </span>
              </div>

              <div class="space-y-2 text-sm text-light-2">
                <p class="flex items-center gap-2">
                  <Icon
                    name="heroicons:check-circle"
                    class="h-4 w-4 text-accent"
                    aria-hidden="true"
                  />
                  {availabilityInfo.responseTime}
                </p>
                {
                  availabilityInfo.meetingAvailable && (
                    <p class="flex items-center gap-2">
                      <Icon
                        name="heroicons:video-camera"
                        class="h-4 w-4 text-accent"
                        aria-hidden="true"
                      />
                      Reunión inicial gratuita (30 min)
                    </p>
                  )
                }
                <p class="flex items-center gap-2">
                  <Icon
                    name="heroicons:globe-americas"
                    class="h-4 w-4 text-accent"
                    aria-hidden="true"
                  />
                  Zona horaria: {availabilityInfo.timezone}
                </p>
              </div>

              <div class="pt-4 border-t border-white/10">
                <p class="text-sm text-light-2 leading-relaxed">
                  {availabilityInfo.description}
                </p>
              </div>
            </div>
          </div>

          <!-- Enhanced FAQ Quick -->
          <div class="rounded-2xl border border-white/5 bg-background/10 p-6 backdrop-blur-xs">
            <h4 class="font-mono text-lg text-accent mb-6 flex items-center gap-2">
              <Icon name="heroicons:question-mark-circle" class="h-5 w-5" aria-hidden="true" />
              Preguntas frecuentes
            </h4>

            <div class="space-y-4">
              {
                faqData.map((faq) => (
                  <details class="group" id={`faq-${faq.id}`}>
                    <summary class="font-mono text-sm text-foreground cursor-pointer hover:text-accent transition-colors duration-200 list-none flex items-center justify-between focus:outline-none focus:ring-2 focus:ring-accent focus:ring-offset-2 focus:ring-offset-background rounded">
                      {faq.question}
                      <Icon
                        name="heroicons:plus"
                        class="w-4 h-4 transition-transform duration-200 group-open:rotate-45"
                        aria-hidden="true"
                      />
                    </summary>
                    <div class="mt-2 text-sm text-light-2 leading-relaxed pl-4 border-l border-accent/30">
                      {faq.answer}
                    </div>
                  </details>
                ))
              }
            </div>
          </div>
        </div>
      </div>

      <!-- CV Download CTA - Centered below both columns -->
      <div
        class="flex justify-center mt-12 md:mt-16"
        data-aos="fade-in"
        data-aos-duration="800"
        data-aos-delay="800"
      >
        <div class="relative group">
          <!-- Campo gravitacional extendido para las partículas - responsive -->
          <div
            class="absolute -inset-4 sm:-inset-8 md:-inset-12 lg:-inset-16 pointer-events-none overflow-hidden"
          >
            <!-- Órbitas de fondo - responsive sizes -->
            <div
              class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-20 h-20 sm:w-24 sm:h-24 md:w-32 md:h-32 border border-accent/10 rounded-full animate-spin"
              style="animation-duration: 8s;"
            >
            </div>
            <div
              class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 border border-accent/20 rounded-full animate-spin"
              style="animation-duration: 6s; animation-direction: reverse;"
            >
            </div>

            <!-- Partículas orbitales - responsive distances -->
            <div
              class="cv-orbital-particle hidden sm:block"
              style="--angle: 0deg; --distance: 40px; --size: 2px; --speed: 4s; --delay: 0s;"
            >
            </div>
            <div
              class="cv-orbital-particle hidden sm:block"
              style="--angle: 90deg; --distance: 35px; --size: 1px; --speed: 3s; --delay: -1s;"
            >
            </div>
            <div
              class="cv-orbital-particle hidden sm:block"
              style="--angle: 180deg; --distance: 45px; --size: 1.5px; --speed: 5s; --delay: -2s;"
            >
            </div>
            <div
              class="cv-orbital-particle hidden sm:block"
              style="--angle: 270deg; --distance: 38px; --size: 2px; --speed: 3.5s; --delay: -3s;"
            >
            </div>

            <!-- Partículas externas - hidden on small screens -->
            <div
              class="cv-particle-far hidden md:block"
              style="--angle: 45deg; --distance: 70px; --size: 1px; --speed: 8s; --delay: 0s;"
            >
            </div>
            <div
              class="cv-particle-far hidden md:block"
              style="--angle: 135deg; --distance: 65px; --size: 1.5px; --speed: 7s; --delay: -2s;"
            >
            </div>
            <div
              class="cv-particle-far hidden md:block"
              style="--angle: 225deg; --distance: 75px; --size: 1px; --speed: 9s; --delay: -4s;"
            >
            </div>
            <div
              class="cv-particle-far hidden md:block"
              style="--angle: 315deg; --distance: 68px; --size: 2px; --speed: 6s; --delay: -6s;"
            >
            </div>
          </div>

          <!-- Enhanced background effects -->
          <div
            class="absolute -inset-1 rounded-2xl blur opacity-20 group-hover:opacity-40 transition duration-700 group-hover:duration-300 bg-gradient-to-r from-accent/30 via-accent-light/20 to-accent/30"
            aria-hidden="true"
          >
          </div>
          <div
            class="absolute -inset-1 rounded-2xl opacity-0 group-hover:opacity-100 transition duration-300 bg-gradient-to-r from-accent/20 via-accent-light/10 to-accent/20"
            aria-hidden="true"
          >
          </div>

          <!-- Enhanced CV Button -->
          <a
            href="/cv.pdf"
            target="_blank"
            rel="noopener noreferrer"
            class="relative flex flex-col items-center justify-center p-6 md:p-8 bg-gradient-to-br from-charcoal/80 via-background/90 to-charcoal/80 border border-border hover:border-accent rounded-2xl transform transition-all duration-300 hover:scale-105 hover:shadow-2xl hover:shadow-accent/10 active:scale-95 group overflow-hidden backdrop-blur-sm focus:outline-none focus:ring-2 focus:ring-accent focus:ring-offset-2 focus:ring-offset-background w-96 md:w-[500px] lg:w-[600px]"
            aria-label="Descargar Curriculum Vitae en formato PDF"
            data-umami-event="cv_download"
            data-umami-event-source="contact_section"
          >
            <!-- Ripple effect -->
            <div
              class="absolute inset-0 opacity-0 group-hover:opacity-10 transition-all duration-500 bg-gradient-to-r from-accent via-accent-light to-accent"
              aria-hidden="true"
            >
            </div>

            <!-- Enhanced Content -->
            <div class="relative flex flex-col items-center gap-4 z-10">
              <!-- Enhanced Icon with effects -->
              <div class="relative">
                <div
                  class="relative w-14 h-14 md:w-16 md:h-16 bg-gradient-to-br from-accent to-accent-light rounded-full flex items-center justify-center group-hover:scale-110 transition-transform duration-300"
                >
                  <Icon
                    name="heroicons:document-arrow-down"
                    class="h-7 w-7 md:h-8 md:w-8 text-background transition-all duration-300 group-hover:scale-110"
                    aria-hidden="true"
                  />
                  <!-- Glow effect -->
                  <div
                    class="absolute inset-0 bg-accent rounded-full opacity-0 group-hover:opacity-30 blur-md scale-150 transition-all duration-300"
                    aria-hidden="true"
                  >
                  </div>
                </div>
                <!-- Orbital ring -->
                <div
                  class="absolute inset-0 w-14 h-14 md:w-16 md:h-16 border-2 border-accent/30 rounded-full animate-spin group-hover:border-accent/60 transition-colors duration-300"
                  style="animation-duration: 3s; will-change: transform;"
                  aria-hidden="true"
                >
                </div>
              </div>

              <!-- Enhanced Text -->
              <div class="text-center">
                <h5
                  class="font-serif text-xl font-bold text-foreground group-hover:text-accent transition-colors duration-300 mb-2"
                >
                  Curriculum Vitae
                </h5>
                <p
                  class="font-mono text-sm text-light-2 group-hover:text-foreground transition-colors duration-300 max-w-xs leading-relaxed"
                >
                  Explorá mi trayectoria completa en el
                  <span class="text-accent font-medium">universo digital</span>
                </p>
              </div>

              <!-- Enhanced Technical indicators -->
              <div
                class="flex items-center gap-4 text-xs font-mono text-light-2/70 group-hover:text-light-2 transition-colors duration-300"
              >
                <span class="flex items-center gap-1">
                  <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse" aria-hidden="true">
                  </div>
                  PDF
                </span>
                <span class="flex items-center gap-1">
                  <Icon name="heroicons:arrow-down-tray" class="h-3 w-3" aria-hidden="true" />
                  Descargar
                </span>
                <span class="flex items-center gap-1">
                  <Icon name="heroicons:document-text" class="h-3 w-3" aria-hidden="true" />
                  2025
                </span>
              </div>
            </div>

            <!-- Ripple effect on active -->
            <div
              class="absolute inset-0 opacity-0 group-active:opacity-100 transition-opacity duration-200"
              aria-hidden="true"
            >
              <div
                class="absolute inset-0 bg-accent opacity-20 rounded-2xl transform scale-0 group-active:scale-100 transition-transform duration-200"
              >
              </div>
            </div>
          </a>

          <!-- Description text -->
          <div class="mt-4 text-center">
            <p
              class="text-xs text-light-2/60 group-hover:text-light-2/80 transition-colors duration-300 font-mono"
            >
              Descarga directa • Actualizado enero 2025
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<style>
  /* Base responsive styles to prevent overflow */
  .container {
    max-width: 100%;
    overflow-x: hidden;
  }

  /* Value Proposition Pills */
  .value-pill {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 0.75rem;
    background: rgba(var(--color-accent-rgb), 0.1);
    border: 1px solid rgba(var(--color-accent-rgb), 0.2);
    border-radius: 9999px;
    color: var(--color-accent-light);
    font-family: 'Space Mono', monospace;
    font-size: 0.75rem;
    font-weight: 500;
    backdrop-filter: blur(8px);
    transition: all 0.3s ease;
  }

  .value-pill:hover {
    background: rgba(var(--color-accent-rgb), 0.15);
    border-color: rgba(var(--color-accent-rgb), 0.3);
    transform: translateY(-1px);
  }

  @media (min-width: 640px) {
    .value-pill {
      font-size: 0.875rem;
      padding: 0.625rem 1rem;
    }
  }

  /* CV Orbital Particles */
  .cv-orbital-particle,
  .cv-particle-far {
    position: absolute;
    width: var(--size);
    height: var(--size);
    background: var(--color-accent);
    border-radius: 50%;
    opacity: 0.8;
    animation: orbital var(--speed) linear infinite var(--delay);
    transform-origin: calc(var(--distance) + var(--size) / 2) center;
    top: 50%;
    left: 50%;
    margin-top: calc(var(--size) / -2);
    margin-left: calc(var(--size) / -2);
    will-change: transform;
  }

  @keyframes orbital {
    from {
      transform: rotate(var(--angle)) translateX(var(--distance)) rotate(calc(-1 * var(--angle)));
    }
    to {
      transform: rotate(calc(var(--angle) + 360deg)) translateX(var(--distance))
        rotate(calc(-1 * (var(--angle) + 360deg)));
    }
  }

  /* Modern Form Styles with CSS custom properties */
  .form-field {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    max-width: 100%;
  }

  .form-label {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    font-family: 'Space Mono', monospace;
    font-size: 0.875rem;
    font-weight: 500;
    color: var(--color-foreground);
    margin-bottom: 0.5rem;
  }

  .label-required {
    color: var(--color-accent);
    font-weight: 600;
  }

  .input-wrapper {
    position: relative;
    display: flex;
    align-items: center;
  }

  .form-input,
  .form-select,
  .form-textarea {
    width: 100%;
    padding: 1rem;
    padding-left: 3rem;
    background: rgba(var(--color-charcoal-rgb), 0.6);
    border: 1px solid var(--color-border);
    border-radius: 0.75rem;
    color: var(--color-foreground);
    font-family: 'Inter', sans-serif;
    font-size: 1rem;
    transition: all 0.2s ease;
    outline: none;
  }

  .form-input::placeholder,
  .form-textarea::placeholder {
    color: var(--color-text-2);
    font-size: 0.9rem;
    opacity: 0.5;
  }

  .form-input:focus,
  .form-select:focus,
  .form-textarea:focus {
    border-color: var(--color-accent);
    box-shadow: 0 0 0 3px rgba(var(--color-accent-rgb), 0.1);
    background: rgba(var(--color-charcoal-rgb), 0.8);
  }

  .form-input:hover,
  .form-select:hover,
  .form-textarea:hover {
    border-color: rgba(var(--color-accent-rgb), 0.3);
  }

  .input-icon {
    position: absolute;
    left: 1rem;
    top: 50%;
    transform: translateY(-50%);
    color: var(--color-accent);
    opacity: 0.7;
    z-index: 1;
  }

  .validation-icon {
    position: absolute;
    right: 1rem;
    top: 50%;
    transform: translateY(-50%);
    z-index: 1;
  }

  .textarea-wrapper {
    position: relative;
  }

  .form-textarea {
    padding-left: 1rem;
    resize: vertical;
    min-height: 120px;
    max-height: 200px;
  }

  .textarea-counter {
    position: absolute;
    bottom: 0.5rem;
    right: 1rem;
    font-size: 0.75rem;
    color: var(--color-light-2);
    opacity: 0.6;
    font-family: 'Space Mono', monospace;
  }

  /* Enhanced Project Pills Styles */
  .project-pills {
    display: flex;
    flex-wrap: wrap;
    gap: 0.375rem;
    max-width: 100%;
  }

  .project-pill {
    cursor: pointer;
    transition: all 0.2s ease;
    max-width: 100%;
  }

  .pill-input {
    display: none;
  }

  .pill-content {
    display: flex;
    align-items: center;
    gap: 0.375rem;
    padding: 0.5rem 0.625rem;
    border: 1px solid var(--color-border);
    border-radius: 9999px;
    background: var(--color-background);
    color: var(--color-light-2);
    font-family: 'Space Mono', monospace;
    font-size: 0.75rem;
    font-weight: 500;
    transition: all 0.2s ease;
    position: relative;
    cursor: pointer;
    max-width: 100%;
    min-width: 0;
  }

  @media (min-width: 768px) {
    .project-pills {
      gap: 0.5rem;
    }

    .pill-content {
      gap: 0.5rem;
      padding: 0.5rem 0.75rem;
    }
  }

  .pill-content:hover {
    border-color: var(--color-accent);
    background: rgba(var(--color-accent-rgb), 0.05);
    color: var(--color-foreground);
    transform: translateY(-1px);
  }

  .pill-content:focus {
    outline: 2px solid var(--color-accent);
    outline-offset: 2px;
  }

  .pill-input:checked + .pill-content,
  .pill-selected {
    border-color: var(--color-accent);
    background: rgba(var(--color-accent-rgb), 0.15);
    color: var(--color-accent);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(var(--color-accent-rgb), 0.2);
  }

  .pill-check {
    position: absolute;
    top: -6px;
    right: -6px;
    width: 1rem;
    height: 1rem;
    background: var(--color-accent);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transform: scale(0);
    transition: all 0.2s ease;
  }

  .pill-check svg {
    color: var(--color-background);
    width: 0.75rem;
    height: 0.75rem;
  }

  .pill-input:checked + .pill-content .pill-check,
  .pill-selected .pill-check {
    opacity: 1;
    transform: scale(1);
  }

  .project-pills-help {
    margin-top: 0.5rem;
    font-size: 0.75rem;
    color: var(--color-light-2);
    opacity: 0.7;
    font-family: 'Space Mono', monospace;
  }

  .form-error {
    display: none;
    align-items: center;
    gap: 0.5rem;
    color: #ef4444;
    font-size: 0.875rem;
    font-family: 'Space Mono', monospace;
  }

  .form-error.show {
    display: flex;
  }

  .form-field.invalid .form-error {
    display: flex;
  }

  .form-help {
    color: var(--color-light-2);
    font-size: 0.75rem;
    opacity: 0.7;
    font-family: 'Space Mono', monospace;
  }

  .form-submit {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .submit-button {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 1.5rem 2rem;
    background: linear-gradient(135deg, var(--color-accent), var(--color-accent-light));
    color: var(--color-background);
    border: none;
    border-radius: 1rem;
    font-family: 'Space Mono', monospace;
    font-weight: 600;
    font-size: 1.125rem;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    min-height: 4rem;
  }

  .submit-button:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px rgba(var(--color-accent-rgb), 0.3);
  }

  .submit-button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    transform: none;
  }

  .button-content {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    transition: opacity 0.2s ease;
    position: absolute;
    inset: 0;
  }

  .button-loader {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    position: absolute;
    inset: 0;
  }

  .button-content.hidden {
    opacity: 0;
    pointer-events: none;
  }

  .button-loader.hidden {
    opacity: 0;
    pointer-events: none;
  }

  .loader-spinner {
    width: 1.25rem;
    height: 1.25rem;
    border: 2px solid transparent;
    border-top: 2px solid currentColor;
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    to {
      transform: rotate(360deg);
    }
  }

  .submit-help {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    font-size: 0.75rem;
    color: var(--color-light-2);
    opacity: 0.8;
    font-family: 'Space Mono', monospace;
  }

  /* Validation States */
  .form-field.valid .form-input,
  .form-field.valid .form-select,
  .form-field.valid .form-textarea {
    border-color: #22c55e;
  }

  .form-field.invalid .form-input,
  .form-field.invalid .form-select,
  .form-field.invalid .form-textarea {
    border-color: #ef4444;
  }

  .form-field.valid .validation-icon {
    display: block;
  }

  /* Mobile Optimizations */
  @media (max-width: 640px) {
    .form-input,
    .form-select,
    .form-textarea {
      font-size: 16px; /* Prevents zoom on iOS */
    }

    .project-pills {
      gap: 0.25rem;
      justify-content: flex-start;
    }

    .pill-content {
      padding: 0.375rem 0.5rem;
      font-size: 0.6875rem;
      gap: 0.25rem;
      min-height: 2rem;
      justify-content: center;
    }

    .pill-content span {
      font-size: 0.6875rem;
      line-height: 1.2;
    }

    .pill-content svg {
      width: 0.875rem;
      height: 0.875rem;
      flex-shrink: 0;
    }

    .pill-check {
      width: 0.875rem;
      height: 0.875rem;
      top: -4px;
      right: -4px;
    }

    .pill-check svg {
      width: 0.375rem;
      height: 0.375rem;
    }
  }

  @media (max-width: 480px) {
    .pill-content {
      justify-content: flex-start;
    }
  }

  /* Success state styles */
  .form-input:disabled,
  .form-textarea:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    pointer-events: none;
  }

  .submit-button.success-state {
    background: rgb(34 197 94) !important;
    border-color: rgb(34 197 94) !important;
    cursor: default !important;
    pointer-events: none !important;
    color: rgb(21 128 61) !important; /* Verde oscuro para el texto */
  }

  .submit-button.success-state:hover {
    background: rgb(34 197 94) !important;
    transform: none !important;
  }
</style>

<script>
  // Lazy load the contact form functionality
  import { initContactForm } from '@/utils/contact-form-client';

  // Initialize contact form when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initContactForm);
  } else {
    initContactForm();
  }
</script>

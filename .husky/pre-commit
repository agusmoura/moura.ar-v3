#!/usr/bin/env sh

# Add Bun to PATH
export PATH="$HOME/.bun/bin:$PATH"

# Format staged files
echo "ğŸ¨ Formatting staged files..."
bun run format || exit 1

# Run linting (allow warnings, fail on errors)
echo "ğŸ” Running ESLint..."
bun run lint --max-warnings=50 || {
    echo "âŒ ESLint found critical errors. Commit blocked."
    exit 1
}

# Run TypeScript and Astro checks (allow warnings)
echo "ğŸ” Type checking..."
bun run check || {
    echo "âš ï¸  Type errors found but allowing commit. Please fix these issues."
    echo "â„¹ï¸  Use 'git commit --no-verify' to skip this check in emergencies."
}